# Yingwu å•†å“ç®¡ç†åå° - ä½¿ç”¨è¯´æ˜

## ä¸€ã€å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿï¼‰

### 1. å®‰è£… Wrangler

```bash
npm install -g wrangler
wrangler login
```

### 2. åˆ›å»ºæ•°æ®åº“å’Œå­˜å‚¨

```bash
cd workers
npm install

# åˆ›å»º D1 æ•°æ®åº“
wrangler d1 create yingwu_products

# è®°ä¸‹ database_idï¼Œæ›´æ–° wrangler.toml ä¸­çš„ database_id

# åˆ›å»º R2 å­˜å‚¨æ¡¶
wrangler r2 bucket create yingwu-images
wrangler r2 bucket create yingwu-images-preview

# åˆå§‹åŒ–æ•°æ®åº“
npm run db:init
```

### 3. éƒ¨ç½²

```bash
npm run deploy
```

è®°ä¸‹éƒ¨ç½²åçš„ URLï¼Œä¾‹å¦‚ï¼š`https://yingwu-admin.xxx.workers.dev`

### 4. é…ç½®å‰ç«¯

ç¼–è¾‘ `src/pages/Admin.tsx`ï¼Œæ›´æ–° API åœ°å€ï¼š

```typescript
const API_BASE_URL = 'https://ä½ çš„workeråœ°å€.workers.dev';
```

### 5. è®¿é—®ç®¡ç†ç•Œé¢

```bash
# å¯åŠ¨å‰ç«¯
cd ..
npm run dev
```

è®¿é—® `http://localhost:5173/admin` å¼€å§‹ç®¡ç†å•†å“ï¼

## äºŒã€åŠŸèƒ½è¯´æ˜

### å•†å“ç®¡ç†

- âœ… æ·»åŠ å•†å“ï¼šç‚¹å‡»"æ·»åŠ å•†å“"æŒ‰é’®
- âœ… ç¼–è¾‘å•†å“ï¼šç‚¹å‡»å•†å“å¡ç‰‡ä¸Šçš„"ç¼–è¾‘"æŒ‰é’®
- âœ… åˆ é™¤å•†å“ï¼šç‚¹å‡»"åˆ é™¤"æŒ‰é’®
- âœ… æŒ‰åˆ†ç±»ç­›é€‰ï¼šä½¿ç”¨é¡¶éƒ¨çš„åˆ†ç±»ä¸‹æ‹‰èœå•

### å›¾ç‰‡ç®¡ç†

- æ”¯æŒä¸Šä¼ å¤šå¼ å›¾ç‰‡
- ç¬¬ä¸€å¼ å›¾ç‰‡è‡ªåŠ¨è®¾ä¸ºä¸»å›¾
- ç¼–è¾‘æ—¶å¯ä»¥æ·»åŠ æ–°å›¾ç‰‡
- å¯ä»¥åˆ é™¤å•å¼ å›¾ç‰‡

### å•†å“åˆ†ç±»

ç³»ç»Ÿæ”¯æŒ 8 ä¸ªåˆ†ç±»ï¼š

1. ç‘œä¼½æœ
2. ç‘œä¼½å™¨å…·
3. è¿åŠ¨ä¼‘é—²ç±»
4. åŠŸèƒ½æ€§æœè£…
5. åŒ…ç±»
6. è»æ‰‹ã¨æ‰‹è¢‹ï¼ˆæ‰‹å¥—ç±»ï¼‰
7. é›‘è²¨é¡ï¼ˆæ‚è´§ç±»ï¼‰
8. ã‚¢ãƒ‹ãƒ¡é¡ï¼ˆåŠ¨æ¼«ç±»ï¼‰

## ä¸‰ã€å¯¼å…¥ç°æœ‰æ•°æ®

å¦‚æœä½ å·²æœ‰å•†å“æ•°æ®ï¼Œå¯ä»¥æ‰¹é‡å¯¼å…¥ï¼š

### æ–¹å¼ 1ï¼šä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd workers

# 1. ä¸Šä¼ å›¾ç‰‡åˆ° R2
npm install --save-dev glob
node scripts/upload-images.js

# 2. ç”Ÿæˆå¹¶å¯¼å…¥äº§å“æ•°æ®
node scripts/import-products.js
wrangler d1 execute yingwu_products --file=./import-data.sql --remote
```

### æ–¹å¼ 2ï¼šæ‰‹åŠ¨æ·»åŠ 

é€šè¿‡ç®¡ç†ç•Œé¢é€ä¸ªæ·»åŠ å•†å“ï¼ˆé€‚åˆå°‘é‡å•†å“ï¼‰ã€‚

## å››ã€æ—¥å¸¸æ“ä½œ

### æŸ¥çœ‹æ—¥å¿—

```bash
cd workers
npm run tail
```

### å¤‡ä»½æ•°æ®åº“

```bash
wrangler d1 export yingwu_products --output=backup.sql
```

### æ¢å¤æ•°æ®åº“

```bash
wrangler d1 execute yingwu_products --file=backup.sql --remote
```

### æŸ¥çœ‹å•†å“åˆ—è¡¨

```bash
wrangler d1 execute yingwu_products --command="SELECT * FROM products" --remote
```

## äº”ã€å¸¸è§é—®é¢˜

### Q1: å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Ÿ

**æ£€æŸ¥ï¼š**
- R2 å­˜å‚¨æ¡¶æ˜¯å¦å·²åˆ›å»º
- å›¾ç‰‡å¤§å°æ˜¯å¦è¶…è¿‡ 5MB
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

### Q2: ç®¡ç†ç•Œé¢æ‰“ä¸å¼€ï¼Ÿ

**æ£€æŸ¥ï¼š**
- Worker æ˜¯å¦å·²éƒ¨ç½²
- API åœ°å€æ˜¯å¦é…ç½®æ­£ç¡®
- æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### Q3: å›¾ç‰‡æ— æ³•æ˜¾ç¤ºï¼Ÿ

**æ£€æŸ¥ï¼š**
- å›¾ç‰‡æ˜¯å¦å·²ä¸Šä¼ åˆ° R2
- å›¾ç‰‡ URL æ˜¯å¦æ­£ç¡®
- Worker çš„å›¾ç‰‡æ¥å£æ˜¯å¦æ­£å¸¸

### Q4: æ•°æ®åº“æ“ä½œå¤±è´¥ï¼Ÿ

**æ£€æŸ¥ï¼š**
- æ•°æ®åº“æ˜¯å¦å·²åˆå§‹åŒ–
- è¡¨ç»“æ„æ˜¯å¦æ­£ç¡®
- database_id æ˜¯å¦é…ç½®æ­£ç¡®

## å…­ã€ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. é…ç½®è‡ªå®šä¹‰åŸŸå

åœ¨ Cloudflare Dashboard ä¸­ï¼š
- è¿›å…¥ Workers & Pages
- é€‰æ‹©ä½ çš„ Worker
- ç‚¹å‡» Triggers â†’ Add Custom Domain
- è¾“å…¥åŸŸåï¼ˆå¦‚ api.your-domain.comï¼‰

### 2. éƒ¨ç½²å‰ç«¯

æ¨èä½¿ç”¨ Cloudflare Pagesï¼š

```bash
# æ¨é€åˆ° GitHub
git add .
git commit -m "Deploy"
git push

# åœ¨ Cloudflare Dashboard ä¸­è¿æ¥ GitHub ä»“åº“
# æ„å»ºè®¾ç½®ï¼š
#   - Framework: Vite
#   - Build command: npm run build
#   - Build output: dist
```

### 3. æ›´æ–° API åœ°å€

å°† `src/pages/Admin.tsx` ä¸­çš„ API åœ°å€æ”¹ä¸ºç”Ÿäº§ç¯å¢ƒåœ°å€ã€‚

### 4. æ·»åŠ èº«ä»½éªŒè¯ï¼ˆé‡è¦ï¼ï¼‰

åœ¨ `src/pages/Admin.tsx` ä¸­æ·»åŠ å¯†ç ä¿æŠ¤ï¼ˆè§ DEPLOYMENT_GUIDE.mdï¼‰ã€‚

## ä¸ƒã€æˆæœ¬è¯´æ˜

### Cloudflare å…è´¹å¥—é¤

- Workers: æ¯å¤© 10 ä¸‡æ¬¡è¯·æ±‚
- D1: æ¯å¤© 5GB è¯»å–
- R2: 10GB å­˜å‚¨
- Pages: æ— é™æµé‡

**ç»“è®ºï¼šä¸­å°å‹ç½‘ç«™å®Œå…¨å…è´¹ï¼**

### ä»˜è´¹å¥—é¤ï¼ˆå¦‚éœ€å‡çº§ï¼‰

- Workers Paid: $5/æœˆï¼ˆ1000 ä¸‡æ¬¡è¯·æ±‚ï¼‰
- R2: $0.015/GB/æœˆ
- D1: $0.75/ç™¾ä¸‡è¡Œè¯»å–

## å…«ã€å®‰å…¨å»ºè®®

âš ï¸ **ç”Ÿäº§ç¯å¢ƒå¿…åšï¼š**

1. ä¸ºç®¡ç†ç•Œé¢æ·»åŠ å¯†ç ä¿æŠ¤
2. é…ç½® CORS åªå…è®¸ä½ çš„åŸŸå
3. å®šæœŸå¤‡ä»½æ•°æ®åº“
4. ä½¿ç”¨ HTTPSï¼ˆCloudflare è‡ªåŠ¨æä¾›ï¼‰
5. è®¾ç½®é€Ÿç‡é™åˆ¶

## ä¹ã€æŠ€æœ¯æ”¯æŒ

### æ–‡æ¡£

- è¯¦ç»† API æ–‡æ¡£ï¼š`workers/README.md`
- å¿«é€Ÿå¼€å§‹ï¼š`workers/QUICK_START.md`
- éƒ¨ç½²æŒ‡å—ï¼š`DEPLOYMENT_GUIDE.md`
- è„šæœ¬è¯´æ˜ï¼š`workers/scripts/README.md`

### æœ‰ç”¨çš„å‘½ä»¤

```bash
# æŸ¥çœ‹ Worker çŠ¶æ€
wrangler whoami

# åˆ—å‡ºæ‰€æœ‰ Workers
wrangler deployments list

# æŸ¥çœ‹æ•°æ®åº“åˆ—è¡¨
wrangler d1 list

# æŸ¥çœ‹ R2 å­˜å‚¨æ¡¶
wrangler r2 bucket list
```

### è·å–å¸®åŠ©

- Cloudflare Workers æ–‡æ¡£ï¼šhttps://developers.cloudflare.com/workers/
- Cloudflare ç¤¾åŒºï¼šhttps://community.cloudflare.com/
- GitHub Issuesï¼ˆå¦‚æœæ˜¯å¼€æºé¡¹ç›®ï¼‰

## åã€ä¸‹ä¸€æ­¥

- [ ] æ·»åŠ å•†å“æœç´¢åŠŸèƒ½
- [ ] å®ç°æ‰¹é‡æ“ä½œ
- [ ] æ·»åŠ æ•°æ®ç»Ÿè®¡
- [ ] ä¼˜åŒ–å›¾ç‰‡åŠ è½½
- [ ] æ·»åŠ å¤šç”¨æˆ·ç®¡ç†

---

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚

