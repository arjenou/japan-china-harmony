# é‚®ä»¶åŠŸèƒ½éƒ¨ç½²æŒ‡å—

## âœ… å·²å®Œæˆçš„å·¥ä½œ

1. **åç«¯ API** - åœ¨ `workers/src/index.ts` ä¸­æ·»åŠ äº† `/api/contact` ç«¯ç‚¹
   - æ¥æ”¶è¡¨å•æ•°æ®
   - å‘é€é‚®ä»¶ç»™ç®¡ç†å‘˜ï¼ˆpostmaster@mono-grp.com.cnï¼‰
   - è‡ªåŠ¨å›å¤ç”¨æˆ·
   - ä½¿ç”¨ MailChannels å…è´¹é‚®ä»¶æœåŠ¡

2. **å‰ç«¯è¡¨å•** - æ›´æ–°äº† `src/components/Contact.tsx`
   - è¡¨å•æäº¤æ—¶è°ƒç”¨åç«¯ API
   - æ˜¾ç¤ºå‘é€ä¸­çŠ¶æ€
   - æˆåŠŸ/å¤±è´¥æç¤º
   - é˜²æ­¢é‡å¤æäº¤

3. **å¤šè¯­è¨€æ”¯æŒ** - æ›´æ–°äº† `src/contexts/LanguageContext.tsx`
   - ä¸­æ–‡ã€æ—¥æ–‡ã€è‹±æ–‡çš„é”™è¯¯æç¤º
   - å‘é€ä¸­çŠ¶æ€æ–‡æœ¬

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. éƒ¨ç½² Cloudflare Workersï¼ˆåç«¯ï¼‰

```bash
cd workers
wrangler login  # é¦–æ¬¡éƒ¨ç½²éœ€è¦ç™»å½•
wrangler deploy
```

**æ³¨æ„**ï¼šå¦‚æœé‡åˆ° `CLOUDFLARE_API_TOKEN` é”™è¯¯ï¼Œè¿è¡Œ `wrangler login` è¿›è¡Œèº«ä»½éªŒè¯ã€‚

### 2. éªŒè¯ API ç«¯ç‚¹

éƒ¨ç½²æˆåŠŸåï¼Œæµ‹è¯• APIï¼š

```bash
curl -X POST https://yingwu-admin.arjenyang.workers.dev/api/contact \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æµ‹è¯•ç”¨æˆ·",
    "email": "test@example.com",
    "company": "æµ‹è¯•å…¬å¸",
    "message": "è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯"
  }'
```

åº”è¯¥è¿”å›ï¼š
```json
{
  "success": true,
  "message": "Email sent successfully"
}
```

### 3. éƒ¨ç½²å‰ç«¯

#### æ–¹æ¡ˆ A: Vercelï¼ˆæ¨èï¼‰

```bash
# å®‰è£… Vercel CLIï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
npm install -g vercel

# æ„å»ºå¹¶éƒ¨ç½²
npm run build
vercel deploy
```

#### æ–¹æ¡ˆ B: ç›´æ¥æ„å»º

```bash
npm run build
# ç„¶åå°† dist ç›®å½•ä¸Šä¼ åˆ°æ‚¨çš„æ‰˜ç®¡æœåŠ¡
```

### 4. æµ‹è¯•å®Œæ•´æµç¨‹

1. è®¿é—®æ‚¨çš„ç½‘ç«™
2. æ»šåŠ¨åˆ°"è”ç³»æˆ‘ä»¬"éƒ¨åˆ†
3. å¡«å†™è¡¨å•å¹¶æäº¤
4. æ£€æŸ¥ï¼š
   - âœ… æ˜¯å¦æ˜¾ç¤º"å‘é€ä¸­..."çŠ¶æ€
   - âœ… æ˜¯å¦æ˜¾ç¤ºæˆåŠŸæç¤º
   - âœ… ç®¡ç†å‘˜é‚®ç®±æ˜¯å¦æ”¶åˆ°é‚®ä»¶
   - âœ… ç”¨æˆ·é‚®ç®±æ˜¯å¦æ”¶åˆ°è‡ªåŠ¨å›å¤

## ğŸ“§ é‚®ä»¶é…ç½®è¯´æ˜

### å½“å‰é…ç½®
- **æ”¶ä»¶äºº**ï¼špostmaster@mono-grp.com.cn
- **å‘ä»¶æœåŠ¡**ï¼šMailChannelsï¼ˆå…è´¹ï¼‰
- **å‘ä»¶åœ°å€**ï¼šnoreply@yingwu-website.workers.dev
- **å›å¤åœ°å€**ï¼šç”¨æˆ·å¡«å†™çš„é‚®ç®±

### é‚®ä»¶å†…å®¹

#### ç®¡ç†å‘˜æ”¶åˆ°çš„é‚®ä»¶
```
ä¸»é¢˜ï¼šæ–°çš„è”ç³»è¡¨å• - [ç”¨æˆ·å§“å]

å†…å®¹ï¼š
- å§“å
- é‚®ç®±
- å…¬å¸
- æ¶ˆæ¯å†…å®¹
```

#### ç”¨æˆ·æ”¶åˆ°çš„è‡ªåŠ¨å›å¤
```
ä¸»é¢˜ï¼šæ„Ÿè°¢æ‚¨çš„å’¨è¯¢ - ä¸Šæµ·è‹±æ­¦å®ä¸š

å†…å®¹ï¼š
- æ„Ÿè°¢è¯­
- ç¡®è®¤å·²æ”¶åˆ°å’¨è¯¢
- å›æ˜¾æäº¤çš„ä¿¡æ¯
- å…¬å¸è”ç³»æ–¹å¼
```

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹æ”¶ä»¶äººé‚®ç®±

ç¼–è¾‘ `workers/src/index.ts`ï¼š

```typescript
const recipientEmail = 'your-email@your-domain.com';  // ç¬¬ 726 è¡Œ
```

### ä¿®æ”¹é‚®ä»¶å†…å®¹

ç¼–è¾‘ `workers/src/index.ts`ï¼š

1. ç®¡ç†å‘˜é‚®ä»¶å†…å®¹ï¼šç¬¬ 729-738 è¡Œï¼ˆ`adminEmailContent`ï¼‰
2. è‡ªåŠ¨å›å¤å†…å®¹ï¼šç¬¬ 741-754 è¡Œï¼ˆ`autoReplyContent`ï¼‰

### ä¿®æ”¹å‰ç«¯ API åœ°å€

å¦‚æœæ‚¨çš„ Workers åŸŸåä¸åŒï¼Œç¼–è¾‘ `src/components/Contact.tsx`ï¼š

```typescript
const response = await fetch('YOUR_WORKERS_URL/api/contact', {  // ç¬¬ 26 è¡Œ
  // ...
});
```

## ğŸ¯ æé«˜é‚®ä»¶é€è¾¾ç‡ï¼ˆå¯é€‰ä½†æ¨èï¼‰

ä¸ºäº†æé«˜é‚®ä»¶é€è¾¾ç‡ï¼Œé¿å…è¢«æ ‡è®°ä¸ºåƒåœ¾é‚®ä»¶ï¼Œå»ºè®®é…ç½® SPF å’Œ DKIMï¼š

### 1. åœ¨ Cloudflare DNS ä¸­æ·»åŠ  SPF è®°å½•

```
ç±»å‹: TXT
åç§°: @
å†…å®¹: v=spf1 include:relay.mailchannels.net ~all
```

### 2. é…ç½® DKIM

åœ¨ `workers/src/index.ts` ä¸­å¯ç”¨ DKIMï¼ˆå·²æ·»åŠ ï¼‰ï¼š

```typescript
dkim_domain: 'mono-grp.com.cn',
dkim_selector: 'mailchannels',
```

ç„¶ååœ¨ DNS ä¸­æ·»åŠ  DKIM è®°å½•ï¼š
```
ç±»å‹: TXT
åç§°: mailchannels._domainkey
å†…å®¹: ï¼ˆéœ€è¦ä» MailChannels è·å–å…¬é’¥ï¼‰
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹ Workers æ—¥å¿—

```bash
cd workers
wrangler tail
```

è¿™ä¼šå®æ—¶æ˜¾ç¤ºæ‰€æœ‰è¯·æ±‚å’Œé”™è¯¯æ—¥å¿—ã€‚

### å¸¸è§é”™è¯¯

1. **CORS é”™è¯¯**
   - æ£€æŸ¥å‰ç«¯åŸŸåæ˜¯å¦æ­£ç¡®
   - Workers å·²é…ç½®å…è®¸æ‰€æœ‰æ¥æºï¼ˆ`origin: '*'`ï¼‰

2. **é‚®ä»¶æœªæ”¶åˆ°**
   - æ£€æŸ¥åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹
   - éªŒè¯é‚®ç®±åœ°å€æ­£ç¡®
   - æŸ¥çœ‹ Workers æ—¥å¿—ç¡®è®¤é‚®ä»¶æ˜¯å¦å‘é€

3. **å‘é€å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - éªŒè¯ Workers æ˜¯å¦æ­£ç¡®éƒ¨ç½²
   - æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

## ğŸ’° æˆæœ¬è¯´æ˜

- **MailChannels**: å®Œå…¨å…è´¹ï¼ˆé€šè¿‡ Cloudflare Workersï¼‰
- **Cloudflare Workers**: å…è´¹ç‰ˆæ¯å¤© 100,000 è¯·æ±‚
- **Cloudflare D1/R2**: ç»§ç»­ä½¿ç”¨ç°æœ‰é…ç½®

é¢„è®¡é‚®ä»¶å‘é€åŠŸèƒ½**é›¶æˆæœ¬è¿è¡Œ**ï¼

## ğŸ”’ å®‰å…¨å»ºè®®

### å½“å‰å®ç°çš„å®‰å…¨æªæ–½
- âœ… è¾“å…¥éªŒè¯ï¼ˆå¿…å¡«å­—æ®µã€é‚®ç®±æ ¼å¼ï¼‰
- âœ… CORS é…ç½®
- âœ… é”™è¯¯å¤„ç†

### å»ºè®®æ·»åŠ ï¼ˆå¯é€‰ï¼‰
1. **é€Ÿç‡é™åˆ¶** - é˜²æ­¢æ»¥ç”¨
2. **reCAPTCHA** - é˜²æ­¢æœºå™¨äºº
3. **å†…å®¹è¿‡æ»¤** - é˜²æ­¢åƒåœ¾ä¿¡æ¯
4. **æ—¥å¿—è®°å½•** - è®°å½•åˆ° D1 æ•°æ®åº“

## ğŸ‰ å¿«é€Ÿæµ‹è¯•å‘½ä»¤

ä¸€é”®æµ‹è¯•æ•´ä¸ªæµç¨‹ï¼š

```bash
# 1. éƒ¨ç½² Workers
cd workers && wrangler deploy

# 2. æµ‹è¯• API
curl -X POST https://yingwu-admin.arjenyang.workers.dev/api/contact \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Test User",
    "email": "test@example.com",
    "message": "Test message"
  }'

# 3. æ„å»ºå‰ç«¯
cd .. && npm run build

# 4. é¢„è§ˆ
npm run preview
```

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Workers æ—¥å¿—ï¼š`wrangler tail`
2. æµè§ˆå™¨æ§åˆ¶å°ï¼šæŸ¥çœ‹ç½‘ç»œè¯·æ±‚å’Œé”™è¯¯
3. é‚®ä»¶è®¾ç½®æŒ‡å—ï¼š`EMAIL_SETUP_GUIDE.md`

---

**ç°åœ¨å°±è¯•è¯•å§ï¼** ğŸš€

